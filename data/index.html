<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta http-equiv="Content-Language" content="en"><meta name="msapplication-TileColor" content="#2d89ef"><meta name="theme-color" content="#4188c9"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="mobile-web-app-capable" content="yes"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta charset="UTF-8"><link href="style.css" rel="stylesheet"><script>var settings;function send(t,e,n){var o=new XMLHttpRequest;o.open(t.method||"POST",t.url||t,!0),o.setRequestHeader("Content-Type",t.content||"application/json; charset=utf-8"),o.addEventListener("load",function(){if(200===o.status)try{n&&n(JSON.parse(o.response))}catch(t){n&&n(!1)}else n&&n(!1)}),o.send(JSON.stringify(e))}function $(t){return document.getElementById(t)}function reboot(){send("reboot",{},function(t){}),$("modal").classList.add("hide")}function loadSettings(){send("settings",{},function(t){if($("loader").classList.add("hide"),t){for(key in t){var e=$(key);e&&(console.log(e.tagName),"SPAN"==e.tagName?e.innerHTML=t[key]:e.value=t[key])}settings=t}})}function logout(){document.cookie="id=",window.location=window.location.href.replace(/:\/\//,"://log:out@"),location.href="/"}window.onload=function(){loadSettings(),"function"==typeof load&&load(),document.body.addEventListener("click",function(t){"function"==typeof click&&click(t);var e=t.target.id;console.log(e),"search"===e&&scan(),"btn_exit"===e&&logout(),"m_no"!==e&&"m_close"!==e||$("modal").classList.add("hide")})}</script><title>Main</title><style>.card .card-image{background:url(http://git.codedevice.ru/img/new.jpg) center center/cover no-repeat;height:200px;border-bottom:1px solid}.card .card-reveal p{margin:0}.b{font-weight:700}.btnInfo,.git,.sett,.vers{position:absolute}.btnInfo{right:23px;bottom:50px;font-size:3rem;cursor:pointer}.sideopen{cursor:pointer}.git,.vers{right:20px;bottom:5px}.sett{bottom:30px;right:20px}.card .card-content{min-height:115px}</style></head><body><div id="loader" class="loader"></div><ul class="nav fix info" id="navbar"><li><a href="index.html" class="brand">Main</a></li><li><a href="settings.html">Settings</a></li><li><a href="service.html">Service</a></li><li class="-exit"><a href="#" id="btn_exit">Exit</a></li><li class="-icon"><a href="#" onclick='document.getElementById("navbar").classList.toggle("res")'>&equiv;</a></li></ul><div id="modal" class="modal hide"><div class="m-cont"><div class="m-head"><span class="close" id="m_close">&times;</span> <span class="m-info">Attention!</span></div><div class="m-body"><p id="m_text">Save the settings and reload the module?</p></div><div class="m-foo"><button id="m_yes" class="info">Yes</button>&nbsp; <button id="m_no">No</button></div></div></div><div class="cont"><div class="row"><div class="s12 m2 l2"></div><div class="s12 m10 l-9"><h2>Main</h2><div class="row"><div class="s12 m10 l-9"><table><thead><tr><th>â„–</th><th>ChipID</th><th>FlashID</th><th>FS Total (byte)</th><th>FS Used (byte)</th></tr></thead><tbody><tr><td>1</td><td>b517900</td><td>1640ef00</td><td>3400046</td><td>47188</td></tr><tr><td>2</td><td>a325540</td><td>4585ff40</td><td>3400046</td><td>20456</td></tr></tbody></table></div></div></div></div></div><footer class="footer"><div class="row"><div class="s12 l11 of-l1"><ul><li class="p-4">ver: <span id="device_firmware"></span></li><li class="p-4"><a href="" target="_blank">Info</a></li></ul></div></div></footer><script>function startEvents() {
      ws = new WebSocket('ws://'+document.location.host+'/ws',['arduino']);
      ws.binaryType = "arraybuffer";
      ws.onopen = function(e){
        console.log("Connected");
      };
      ws.onclose = function(e){
        console.log("Disconnected");
      };
      ws.onerror = function(e){
        console.log("ws error", e);
        console.log("Error");
      };
      ws.onmessage = function(e){
        var msg = "";
        if(e.data instanceof ArrayBuffer){
          var bytes = new Uint8Array(e.data);
          let buffer = new ArrayBuffer(16);
          // let buffer = new ArrayBuffer(e.data);
          for (var i = 0; i < bytes.length; i++) {
            buffer[i]=bytes[i] 
            console.log(i + ":" + bytes[i])
            // buffer[i] = 
            // msg += String.fromCharCode(bytes[i]);
          }
          let card = new Uint32Array(buffer, 0, 1);
          let time = new Uint32Array(buffer, 4, 1);
          let state = new Float32Array(buffer, 8, 1);
          let checksum = new Uint8Array(buffer, 12, 1);
          let isSend = new Uint8Array(buffer, 13, 1);
          let uu = new Uint8Array(buffer, 14, 1);
          let hh = new Uint8Array(buffer, 15, 1);
          console.log(card[0])
          console.log(time)
          console.log(state)
          console.log(checksum[0])
          console.log(isSend)
          
        } else {
          msg = "TXT:"+e.data;
          // msg = "LEGHTH:"+e.data.length;
        }
        console.log(msg);
        console.log(msg.length);
      };
      // ge("input_el").onkeydown = function(e){
      //   stb();
      //   if(e.keyCode == 13 && ge("input_el").value != ""){
      //     ws.send(ge("input_el").value);
      //     ge("input_el").value = "";
      //   }
      // }

    }

    function load(){
      startEvents();
    }</script></body></html>