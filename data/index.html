<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta http-equiv="Content-Language" content="en"><meta name="msapplication-TileColor" content="#2d89ef"><meta name="theme-color" content="#4188c9"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="mobile-web-app-capable" content="yes"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta charset="UTF-8"><link href="bootstrap.css" rel="stylesheet"><script src="jquery.js"></script><script src="bootstrap.js"></script><script>var settings;function send(e,t,o){var n=new XMLHttpRequest;n.open(e.method||"POST",e.url||e,!0),n.setRequestHeader("Content-Type",e.content||"application/json; charset=utf-8"),n.addEventListener("load",function(){if(200===n.status)try{o&&o(JSON.parse(n.response))}catch(e){o&&o(!1)}else o&&o(!1)}),n.send(JSON.stringify(t))}function $(e){return document.getElementById(e)}function reboot(){send("reboot",{},function(e){}),$("modal").classList.add("hide")}function loadSettings(){if(res={server_url:"192.168.1.37",server_port:3e3,http_mode:1,http_login:"admin",http_pass:"admin",wifi_mode:3,wifi_ssid:"sfinks_72",wifi_pass:"ub,bcrec",device_location:"brig6",device_id:542265,device_firmware:"0.0.6"},res){for(key in res){var e=$(key);console.log(e),e&&(console.log(e.tagName),"SPAN"==e.tagName||e.value(res[key]))}settings=res}}function logout(){document.cookie="id=",window.location=window.location.href.replace(/:\/\//,"://log:out@"),location.href="/"}window.onload=function(){loadSettings(),"function"==typeof load&&load(),document.body.addEventListener("click",function(e){"function"==typeof click&&click(e);var t=e.target.id;console.log(t),"search"===t&&scan(),"btn_exit"===t&&logout(),"m_no"!==t&&"m_close"!==t||$("modal").classList.add("hide")})}</script><title>Main</title><style></style></head><body><nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top"><div class="container-fluid"><a class="navbar-brand" href="#">Navbar</a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item"><a class="nav-link active" aria-current="page" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="settings.html">Settings</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Service</a><ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="service.html">Update</a></li><li><a class="dropdown-item" href="upload">Upload</a></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="heap">Heap</a></li></ul></li></ul><form class="d-flex"><input class="form-control me-2" type="search" placeholder="Search" aria-label="Search"> <button class="btn btn-outline-success" type="submit">Search</button></form></div></div></nav><div class="container"><div class="row"><div class="col-sm-12 col-md-2 col-lg-2"></div><div class="col-sm-12 col-md-10 col-lg-9"><h2>Main</h2><div class="row"><div class="col-sm-12 col-md-10 col-lg-9"><table id="table"><thead><tr><th>№</th><th>Card ID</th><th>Time</th><th>Type</th><th>Status</th></tr></thead><tbody></tbody></table></div></div></div></div></div><footer class="footer"></footer><script>var ws,count=1;function getInt(e){return e.reduce(function(e,n,t){return e|n<<8*(3-t)},0)}function codeHex2Txt(e){var n=e.toUpperCase(),t=n.length,o=n.substring(0,t-4),r=n.substring(t-4),s=parseInt(o,16),c=parseInt(r,16);return("000"+s).slice(-3)+","+("00000"+c).slice(-5)}function codeHex2Dec(e){var n=e.toUpperCase();return("0000000000"+parseInt(n,16)).slice(-10)}function codeDec2Hex(e){return("000000"+parseInt(e,10).toString(16)).slice(-6).toUpperCase()}function addTable(e,n,t,o,r){var s=document.getElementById("table").getElementsByTagName("tbody")[0].insertRow(0),c=s.insertCell(0),a=s.insertCell(1),i=s.insertCell(2),l=s.insertCell(3),u=s.insertCell(4),g=60*(new Date).getTimezoneOffset();d=new Date(1e3*(n+g)),c.innerHTML=count,a.innerHTML=codeHex2Txt(codeDec2Hex(e)),i.innerHTML=d.getDate()+"-"+d.getMonth()+"-"+d.getFullYear()+" "+d.getHours()+":"+d.getMinutes(),l.innerHTML=t?"Прибыл":"Убыл",u.innerHTML=r,count++}function startEvents(){(ws=new WebSocket("ws://"+document.location.host+"/ws",["arduino"])).binaryType="arraybuffer",ws.onopen=function(e){console.log("Connected")},ws.onclose=function(e){console.log("Disconnected")},ws.onerror=function(e){console.log("ws error",e),console.log("Error")},ws.onmessage=function(e){var n="";if(e.data instanceof ArrayBuffer)for(var t=new Uint8Array(e.data),o=0,r=0;r<t.length/16;r++){var s=getInt([t[o+3],t[o+2],t[o+1],t[o+0]]),c=getInt([t[o+7],t[o+6],t[o+5],t[o+4]]),a=getInt([t[o+11],t[o+10],t[o+9],t[o+8]]),i=t[o+12],l=t[o+13],u=t[o+14],d=t[o+15];addTable(s,c,i,d,l),console.log(s,c,a,i,l,u,d),o+=16}else n="TXT:"+e.data,console.log(n)}}function load(){$("index").classList.add("active"),startEvents()}function click(e){e.target.id}</script></body></html>