<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta http-equiv="Content-Language" content="en"><meta name="msapplication-TileColor" content="#2d89ef"><meta name="theme-color" content="#4188c9"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="mobile-web-app-capable" content="yes"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta charset="UTF-8"><link href="bootstrap.css" rel="stylesheet"><script src="bootstrap.js"></script><script>var settings;function send(o,t,n){var e=new XMLHttpRequest;e.open(o.method||"POST",o.url||o,!0),e.setRequestHeader("Content-Type",o.content||"application/json; charset=utf-8"),e.addEventListener("load",function(){if(200===e.status)try{n&&n(JSON.parse(e.response))}catch(o){n&&n(!1)}else n&&n(!1)}),e.send(JSON.stringify(t))}function reboot(){send("reboot",{},function(o){}),$("modal").classList.add("hide")}function loadSettings(){send("settings",{},function(o){if(o){for(key in o){var t=$("#"+key);console.log(t),t&&(console.log(t.tagName),"SPAN"==t.tagName||t.value(o[key]))}settings=o}})}function logout(){document.cookie="id=",window.location=window.location.href.replace(/:\/\//,"://log:out@"),location.href="/"}window.onload=function(){loadSettings(),"function"==typeof load&&load(),document.body.addEventListener("click",function(o){"function"==typeof click&&click(o);var t=o.target.id;console.log(t),"search"===t&&scan(),"btn_exit"===t&&logout(),"m_no"!==t&&"m_close"!==t||$("modal").classList.add("hide")})}</script><title>Service</title><style></style></head><body><nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top"><div class="container-fluid"><a class="navbar-brand" href="#">Navbar</a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item"><a class="nav-link active" aria-current="page" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="settings.html">Settings</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Service</a><ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="service.html">Update</a></li><li><a class="dropdown-item" href="upload">Upload</a></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="heap">Heap</a></li></ul></li></ul><form class="d-flex"><input class="form-control me-2" type="search" placeholder="Search" aria-label="Search"> <button class="btn btn-outline-success" type="submit">Search</button></form></div></div></nav><div id="cont" class="cont"><div class="row"><div class="s12 of-m2 m10 of-l2 l8"><h2>Service:</h2><div class="row"><div class="s12 m10"><div class="group"><span>File firmware</span> <input id="update" type="file" name="update" accept=".bin"></div></div></div><div class="row right"><div class="s12 m10"><div class="group"><button class="info" id="btn_update">Update</button></div></div></div></div></div></div><footer class="footer"></footer><script>function sendFile() {
      $("modal").classList.add("hide")
      $("loader").classList.remove("hide")
      var photo = $("update").files[0];
      var req = new XMLHttpRequest();
      var formData = new FormData();
      formData.append("update", photo);
      req.open("POST", '/update');
      req.addEventListener("load", function () {
      if (req.status === 200) {        
        $("loader").classList.add("hide")
        alert("Update:" + req.response);        
      }
    });
      req.send(formData);
    }

    function load() {
      $("service").classList.add("active")

      $("update").addEventListener("change", function handleFiles() {
        const fileList = this.files;
        console.log(fileList)
      }, false);

    }

    function click(event) {
      var id = event.target.id;
      if (id === "btn_update") {
        var file = $("update").files[0];
        if (file) {
          $("m_text").innerHTML = "Update module?"
          $("modal").classList.remove("hide")
        } else {
          $("update").click()
        }
      }
      if (id === "m_yes") {
        sendFile();

      }


    }</script></body></html>