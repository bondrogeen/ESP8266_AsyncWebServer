<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta http-equiv="Content-Language" content="en"><meta name="msapplication-TileColor" content="#2d89ef"><meta name="theme-color" content="#4188c9"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="mobile-web-app-capable" content="yes"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta charset="UTF-8"><link href="style.css" rel="stylesheet"><script>var settings;function send(t,e,n){var o=new XMLHttpRequest;o.open(t.method||"POST",t.url||t,!0),o.setRequestHeader("Content-Type",t.content||"application/json; charset=utf-8"),o.addEventListener("load",function(){if(200===o.status)try{n&&n(JSON.parse(o.response))}catch(t){n&&n(!1)}else n&&n(!1)}),o.send(JSON.stringify(e))}function $(t){return document.getElementById(t)}function reboot(){send("reboot",{},function(t){}),$("modal").classList.add("hide")}function loadSettings(){send("settings",{},function(t){if($("loader").classList.add("hide"),t){for(key in t){var e=$(key);e&&(console.log(e.tagName),"SPAN"==e.tagName?e.innerHTML=t[key]:e.value=t[key])}settings=t}})}function logout(){document.cookie="id=",window.location=window.location.href.replace(/:\/\//,"://log:out@"),location.href="/"}window.onload=function(){loadSettings(),"function"==typeof load&&load(),document.body.addEventListener("click",function(t){"function"==typeof click&&click(t);var e=t.target.id;console.log(e),"search"===e&&scan(),"btn_exit"===e&&logout(),"m_no"!==e&&"m_close"!==e||$("modal").classList.add("hide")})}</script><title>Settings</title><style></style></head><body><div id="loader" class="loader"></div><ul class="nav fix info" id="navbar"><li><a id="index" href="index.html" class="brand">Main</a></li><li><a id="settings" href="settings.html">Settings</a></li><li><a id="service" href="service.html">Service</a></li><li class="-exit"><a href="#" id="btn_exit">Exit</a></li><li class="-icon"><a href="#" onclick='document.getElementById("navbar").classList.toggle("res")'>&equiv;</a></li></ul><div id="modal" class="modal hide"><div class="m-cont"><div class="m-head"><span class="close" id="m_close">&times;</span> <span class="m-info">Attention!</span></div><div class="m-body"><p id="m_text">Save the settings and reload the module?</p></div><div class="m-foo"><button id="m_yes" class="info">Yes</button>&nbsp; <button id="m_no">No</button></div></div></div><div class="cont"><div class="row"><div class="s12 m2 l2"></div><div class="s12 m10 l9"><h2>Settings</h2><div class="row"><div class="s12 m6 l6"><h3>Wi-Fi :</h3><div class="row center"><div class="s12 m10"><div class="group"><select id="wifi_mode" class="value"><option value="0" disabled="disabled">Disable</option><option value="1" disabled="disabled">Station</option><option value="2" disabled="disabled">Access point</option><option value="3">STA and AP</option></select> <span>Mode :</span></div></div></div><div class="row center"><div class="s12 m10"><div class="group"><div class="search"><input id="wifi_ssid" name="wifi_ssid" class="value" type="text" required=" " value=""> <label for="wifi_ssid">Name (SSID)</label><input id="search" type="submit" value="Scan"><ul id="list" style="display:none"></ul></div></div></div><div class="s12 m10"><div class="group"><input id="wifi_pass" type="password" class="value" required="" value=""> <label for="wifi_pass">Password</label></div></div></div></div><div class="s12 m6 l6"><h3>Network :</h3><div class="row center"><div class="s12 m10"><div class="group"><input id="net_ip" type="text" class="value" required="" value="192.168.1.10"> <label for="net_ip">IP address</label></div></div></div><div class="row center"><div class="s12 m10"><div class="group"><input id="net_mask" type="text" class="value" required="" value="255.255.255.0"> <label for="net_mask">Subnet mask</label></div></div></div><div class="row center"><div class="s12 m10"><div class="group"><input id="net_geteway" type="text" class="value" required="" value="192.168.1.1"> <label for="net_geteway">Gateway</label></div></div></div></div><div class="s12 m6 l6"><h3>Authentication :</h3><div class="row center"><div class="s12 m10"><div class="group"><select id="http_mode" class="value"><option value="1">ON</option><option value="0">OFF</option></select> <span>Mode :</span></div></div></div><div class="row center"><div class="s12 m10"><div class="group"><input id="http_login" type="text" class="value" required="" value=""> <label for="http_login">Login</label></div></div></div><div class="row center"><div class="s12 m10"><div class="group"><input id="http_pass" type="password" class="value" required="" value=""> <label for="http_pass">Password</label></div></div></div></div><div class="s12 m6 l6"><h3>Server :</h3><div class="row center"><div class="s12 m10"><div class="group"><input id="server_url" type="text" class="value" required="" value=""> <label for="server_url">Server url</label></div></div></div><div class="row center"><div class="s12 m10"><div class="group"><input id="server_port" type="number" class="value" required="" value=""> <label for="server_port">Port</label></div></div></div><div class="row center"><div class="s12 m10"><div class="group"><input id="device_location" type="text" class="value" required="" value=""> <label for="device_location">Location name</label></div></div></div></div><div class="s12 m6 l6"><h3>Device :</h3><div class="row center"><div class="s12 m10"><div class="group"><input id="device_time" type="datetime-local" value="2020-12-31T08:30" pattern="[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}" required> <label for="device_time">Time and data</label></div></div></div><div class="row center"><div class="s12 m10"><div class="group"><input id="device_id" type="text" required="" value="" disabled="disabled"> <label for="device_id" style="top:-20px;font-size:14px">Device ID</label></div></div></div></div></div><div class="row end"><div class="s12 m10"><div class="group"><button class="info" id="btn_save">Save</button></div></div></div></div></div></div><footer class="footer"><div class="row"><div class="s12 l11 of-l1"><ul><li class="p-4">ver: <span id="device_firmware"></span></li><li class="p-4"><a href="" target="_blank">Info</a></li></ul></div></div></footer><script>function load(){$("settings").classList.add("active")}function scan(){$("loader").classList.remove("hide"),send("scan",{},function(s){if(s&&0<s.length){var a="";s.forEach(function(s,e,i){a+='<li id="'+s.ssid+'"><b>'+s.ssid+"</b> rssi : "+s.rssi+" channel : "+s.channel+"</li>"}),$("list").innerHTML=a}else $("list").innerHTML="<li>No networks found. Try scanning again</li>";$("list").style.display="block",$("loader").classList.add("hide")})}function save(){$("modal").classList.add("hide");for(var s={},e=document.getElementsByClassName("value"),i=0,a=0|e.length;i<a;i=i+1|0){var n,l=e[i].id;if("SELECT"==e[i].tagName)for(var t=0;t<e[i].options.length|0;t++)e[i].options[t].selected&&""!==(n=e[i].options[t].value)&&(s[l]=/^-{0,1}\d+$/.test(n)?Number(n):n);if("INPUT"==e[i].tagName)if(n=e[i].value,console.log(),e[i].disabled||""===n){if(!e[i].disabled)return void e[i].focus()}else s[l]=/^-{0,1}\d+$/.test(n)?Number(n):n}console.log(s),$("modal").classList.remove("hide"),send("settings",s,function(s){console.log(s)},"PUT")}function click(s){"LI"===s.target.tagName&&("m_yes"===id&&reboot(),"btn_save"===id&&save(),id&&($("wifi_ssid").value=id,$("wifi_pass").value="",$("wifi_pass").focus(),$("wifi_mode").value="3")),$("list").style.display="none"}</script></body></html>